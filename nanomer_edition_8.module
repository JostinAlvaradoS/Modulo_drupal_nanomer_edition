<?php

/**
 * @file
 * Primary module hooks for Nanomer Edition 8 module.
 */

use Drupal\nanomer_edition_8\InstallFields;

/**
 * Implements hook_install().
 */
function nanomer_edition_8_install() {
  // El content type se crea automáticamente desde config/install/node.type.nanomer_edition_8.yml
  // Aquí solo creamos los campos para el content type
  \Drupal::logger('nanomer_edition_8')->info('hook_install() called - starting field creation');
  InstallFields::createFields();
  \Drupal::logger('nanomer_edition_8')->info('hook_install() completed');
}

/**
 * Implements hook_uninstall().
 */
function nanomer_edition_8_uninstall() {
  // Eliminar todos los campos creados programáticamente
  \Drupal::logger('nanomer_edition_8')->info('hook_uninstall() called - starting field deletion');
  InstallFields::deleteFields();
  // También eliminar la configuración del tipo de contenido si existe
  try {
    $config_factory = \Drupal::configFactory();
    $config_name = 'node.type.nanomer_edition_8';
    $config_editable = $config_factory->getEditable($config_name);
    if ($config_editable) {
      $config_editable->delete();
      \Drupal::logger('nanomer_edition_8')->info('Deleted config: @c', ['@c' => $config_name]);
    }
  }
  catch (\Exception $e) {
    \Drupal::logger('nanomer_edition_8')->error('Error deleting config node type: @msg', ['@msg' => $e->getMessage()]);
  }
  \Drupal::logger('nanomer_edition_8')->info('hook_uninstall() completed');
}

/**
 * Implements hook_theme().
 */
function nanomer_edition_8_theme($existing, $type, $theme, $path) {
  return [
    'node__nanomer_edition_8' => [
      'base hook' => 'node',
      'path' => $path . '/templates',
      'template' => 'node--nanomer-edition-8',
    ],
  ];
}
